@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Base Theme */
    --background: 222 47% 8%;
    --foreground: 210 40% 96%;
    --card: 222 47% 11%;
    --card-foreground: 210 40% 96%;
    --popover: 222 47% 11%;
    --popover-foreground: 210 40% 96%;
    --primary: 217 91% 60%;
    --primary-foreground: 222 47% 8%;
    --secondary: 217 33% 17%;
    --secondary-foreground: 210 40% 96%;
    --muted: 217 33% 17%;
    --muted-foreground: 215 20% 65%;
    --accent: 262 83% 58%;
    --accent-foreground: 210 40% 96%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 210 40% 96%;
    --border: 217 33% 17%;
    --input: 217 33% 17%;
    --ring: 217 91% 60%;
    --radius: 0.75rem;

    /* Semantic Risk Zone Colors (WCAG AA+ Compliant) */
    --risk-safe: 142 71% 45%;
    --risk-caution: 48 96% 47%;
    --risk-danger: 0 84% 60%;
    --risk-critical: 0 72% 51%;

    /* Support Level Gradient */
    --support-negligible: 220 14% 91%;
    --support-emerging: 142 77% 85%;
    --support-growing: 142 72% 73%;
    --support-solid: 142 71% 45%;
    --support-dominant: 142 64% 30%;

    /* Unified Game Colors */
    --game-cyan: 190 100% 50%;
    --game-purple: 262 83% 58%;
    --game-green: 142 71% 45%;
    --game-amber: 38 92% 50%;
    --game-red: 0 84% 60%;
    --game-gold: 45 93% 58%;

    /* Standardized Shadow System
     * Use these consistent shadow patterns across all components:
     * - shadow-panel: Default panel/card elevation
     * - shadow-panel-hover: Hover state with glow
     * - shadow-modal: Modal/overlay elevation
     * - shadow-glow-primary: Primary color glow effect
     * - shadow-glow-accent: Accent color glow effect
     */
    --shadow-panel: 0 4px 24px rgba(0, 0, 0, 0.4);
    --shadow-panel-hover: 0 8px 32px rgba(0, 0, 0, 0.5);
    --shadow-modal: 0 12px 48px rgba(0, 0, 0, 0.6);
    --shadow-glow-primary: 0 0 20px hsl(var(--primary) / 0.15);
    --shadow-glow-accent: 0 0 20px hsl(var(--accent) / 0.15);
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    background: linear-gradient(135deg, hsl(222 47% 8%) 0%, hsl(222 47% 11%) 50%, hsl(230 50% 15%) 100%);
    min-height: 100vh;
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
  }

  /* Scrollbar Styling */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-secondary rounded;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-border rounded;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-muted-foreground;
  }
}

/* ===== Glass Panel ===== */
.glass-panel {
  @apply bg-card/85 backdrop-blur-xl border border-border rounded-xl p-5;
  box-shadow: var(--shadow-panel);
  transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.glass-panel:hover {
  border-color: hsl(var(--primary) / 0.3);
  box-shadow: var(--shadow-panel-hover), var(--shadow-glow-primary);
}

/* ===== Section Header ===== */
.section-header {
  @apply flex items-center gap-2 mb-4 pb-3 border-b border-border;
}

.section-header h5 {
  @apply m-0 font-semibold text-foreground;
}

.section-header__icon {
  @apply text-cyan;
}

/* ===== Stats Bar ===== */
.stats-bar {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.stat-card {
  @apply flex items-center gap-3 bg-white/5 border border-border rounded-lg px-4 py-3;
  border-left-width: 3px;
  transition: all 0.15s ease-out;
}

.stat-card:hover {
  @apply bg-white/10;
  transform: translateY(-2px);
}

.stat-card--cyan { border-left-color: hsl(var(--game-cyan)); }
.stat-card--purple { border-left-color: hsl(var(--game-purple)); }
.stat-card--green { border-left-color: hsl(var(--game-green)); }
.stat-card--yellow { border-left-color: hsl(var(--game-amber)); }
.stat-card--red { border-left-color: hsl(var(--game-red)); }

.stat-card--streak {
  background: linear-gradient(135deg, hsl(var(--game-gold) / 0.1), hsl(var(--game-amber) / 0.05));
  border-color: hsl(var(--game-gold) / 0.5);
}

.stat-icon {
  @apply p-2 rounded;
}

.stat-icon--cyan { color: hsl(var(--game-cyan)); background: hsl(var(--game-cyan) / 0.15); }
.stat-icon--purple { color: hsl(var(--game-purple)); background: hsl(var(--game-purple) / 0.15); }
.stat-icon--green { color: hsl(var(--game-green)); background: hsl(var(--game-green) / 0.15); }
.stat-icon--yellow { color: hsl(var(--game-amber)); background: hsl(var(--game-amber) / 0.15); }
.stat-icon--red { color: hsl(var(--game-red)); background: hsl(var(--game-red) / 0.15); }

.stat-content {
  @apply flex flex-col;
}

.stat-label {
  @apply text-xs uppercase tracking-wide text-muted-foreground;
}

.streak-icon { color: hsl(var(--game-amber)); }
.streak-value { @apply font-bold text-xl; color: hsl(var(--game-gold)); }

/* ===== Risk Meter ===== */
.risk-meter-container {
  @apply w-full;
}

.risk-meter-header {
  @apply flex justify-between items-center mb-2;
}

.risk-meter-label {
  @apply flex items-center gap-1.5 text-xs font-semibold uppercase tracking-wide;
}

.risk-meter-label--low { color: hsl(var(--risk-safe)); }
.risk-meter-label--medium { color: hsl(var(--risk-caution)); }
.risk-meter-label--high { color: hsl(var(--risk-danger)); }
.risk-meter-label--critical { color: hsl(var(--risk-critical)); }

.risk-meter-value { @apply font-bold text-lg; }
.risk-meter-value--low { color: hsl(var(--risk-safe)); }
.risk-meter-value--medium { color: hsl(var(--risk-caution)); }
.risk-meter-value--high { color: hsl(var(--risk-danger)); }
.risk-meter-value--critical { color: hsl(var(--risk-critical)); }

.risk-meter {
  @apply w-full h-2 bg-secondary rounded overflow-hidden;
}

.risk-meter__fill {
  @apply h-full rounded;
  transition: width 0.5s cubic-bezier(0.16, 1, 0.3, 1);
}

.risk-meter__fill--low { background: linear-gradient(90deg, hsl(var(--risk-safe)), hsl(142 72% 60%)); }
.risk-meter__fill--medium { background: linear-gradient(90deg, hsl(var(--risk-caution)), hsl(48 95% 65%)); }
.risk-meter__fill--high { background: linear-gradient(90deg, hsl(var(--risk-danger)), hsl(0 72% 55%)); }
.risk-meter__fill--critical {
  background: linear-gradient(90deg, hsl(var(--risk-critical)), hsl(0 84% 45%));
  animation: risk-pulse 1s ease-in-out infinite;
}

.risk-warning {
  @apply flex items-center gap-1.5 mt-2 text-xs text-red-500;
  animation: shake 0.5s ease-in-out;
}

/* ===== Action Button ===== */
.action-btn {
  @apply relative block w-full rounded-xl px-5 py-4 text-left cursor-pointer overflow-hidden mb-3;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.03) 0%, rgba(255, 255, 255, 0.06) 100%);
  border: 1px solid rgba(255, 255, 255, 0.08);
  color: hsl(210 40% 96%);
  transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.action-btn:hover:not(:disabled) {
  border-color: hsl(var(--primary) / 0.4);
  box-shadow: 0 0 20px hsl(var(--primary) / 0.15);
  transform: translateY(-2px);
}

.action-btn:active:not(:disabled) {
  transform: scale(0.98);
}

.action-btn:disabled,
.action-btn--disabled {
  @apply cursor-not-allowed;
  opacity: 0.65;
  filter: grayscale(0.25);
}

.action-btn:disabled .action-btn__name,
.action-btn--disabled .action-btn__name {
  color: hsl(var(--muted-foreground));
}

.action-btn__content {
  @apply relative z-10;
}

.action-btn__header {
  @apply flex items-center gap-2 mb-1;
}

.action-btn__name {
  @apply font-semibold text-foreground;
}

.action-btn__lock {
  @apply text-muted-foreground;
}

.action-btn__description {
  @apply text-sm text-muted-foreground m-0 mb-2;
}

.action-btn__cost {
  @apply flex gap-3;
}

.cost-item {
  @apply inline-flex items-center gap-1 text-xs font-medium px-2 py-0.5 rounded;
}

.cost-item--funds {
  color: hsl(var(--game-green));
  background: hsl(var(--game-green) / 0.15);
}

.cost-item--clout {
  color: hsl(var(--game-cyan));
  background: hsl(var(--game-cyan) / 0.15);
}

.action-ripple {
  @apply absolute bg-cyan rounded-full pointer-events-none;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  transform: translate(-50%, -50%);
}

.critical-badge {
  @apply inline-flex items-center gap-1 text-xs font-bold px-2 py-0.5 rounded;
  color: hsl(var(--game-gold));
  background: hsl(var(--game-gold) / 0.2);
}

/* ===== News Feed ===== */
.news-feed, .social-feed {
  max-height: 200px;
  overflow-y: auto;
}

.news-item {
  @apply flex gap-2 py-2 border-b border-border text-sm text-muted-foreground;
  transition: all 0.15s ease-out;
}

.news-item:hover {
  @apply text-foreground pl-2;
}

.news-item:last-child {
  @apply border-b-0;
}

.news-marker {
  color: hsl(var(--game-purple));
}

/* ===== Tweet Card ===== */
.tweet-card {
  @apply bg-white/5 border border-border rounded-lg p-3 mb-2;
  transition: all 0.15s ease-out;
}

.tweet-card:hover {
  @apply bg-white/10;
  border-color: hsl(var(--primary));
}

.tweet-user {
  @apply font-semibold mr-2;
  color: hsl(var(--game-cyan));
}

.tweet-content {
  @apply text-sm text-muted-foreground;
}

/* ===== Map ===== */
.map-container {
  @apply relative;
}

.map-legend {
  @apply flex flex-wrap gap-3 justify-center;
}

.legend-item {
  @apply flex items-center gap-1.5;
}

.legend-color {
  @apply w-3 h-3 rounded-sm;
}

.legend-label {
  @apply text-xs text-muted-foreground;
}

.usa-map-wrapper {
  @apply w-full;
}

.usa-map-wrapper svg {
  @apply w-full h-auto;
}

.usa-map-wrapper path {
  transition: all 0.3s ease-out;
  cursor: pointer;
}

.usa-map-wrapper path:hover {
  filter: brightness(1.2) drop-shadow(0 0 8px hsl(var(--primary)));
}

.map-tooltip {
  @apply absolute rounded-lg px-3 py-2 z-10 whitespace-nowrap;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: hsl(var(--card));
  border: 1px solid hsl(var(--primary) / 0.3);
  box-shadow: 0 0 20px hsl(var(--primary) / 0.15);
}

.tooltip-header {
  @apply flex items-center gap-1.5 font-semibold text-foreground;
}

.tooltip-value {
  @apply text-sm text-muted-foreground;
}

.map-stats {
  @apply text-center;
}

.avg-support-badge {
  @apply inline-flex items-center gap-2 bg-white/5 border border-border rounded-lg px-4 py-2;
}

.avg-support-badge .label {
  @apply text-sm text-muted-foreground;
}

.avg-support-badge .value {
  @apply font-bold text-lg;
  color: hsl(var(--game-green));
}

.avg-support-badge.victory {
  border-color: hsl(var(--game-gold));
  box-shadow: 0 0 30px hsl(var(--game-gold) / 0.3);
}

.avg-support-badge.victory .value {
  color: hsl(var(--game-gold));
}

/* ===== Advisors ===== */
.advisors-grid {
  @apply flex flex-col gap-3;
}

.advisor-card {
  @apply bg-white/5 border border-border rounded-xl p-4;
  transition: all 0.3s ease-out;
}

.advisor-card:hover {
  border-color: hsl(var(--game-purple));
  box-shadow: 0 0 20px hsl(var(--game-purple) / 0.15);
}

.advisor-header {
  @apply flex items-center gap-3 mb-2;
}

.advisor-avatar {
  @apply w-10 h-10 flex items-center justify-center font-bold text-white rounded-full;
  background: linear-gradient(135deg, hsl(var(--game-cyan)), hsl(var(--game-purple)));
}

.advisor-info {
  @apply flex flex-col;
}

.advisor-name {
  @apply text-foreground;
}

.advisor-role {
  @apply text-xs text-muted-foreground;
}

.advisor-traits {
  @apply text-sm italic mb-2;
  color: hsl(var(--game-cyan));
}

.advisor-quotes {
  @apply flex flex-col gap-1;
}

.advisor-quote {
  @apply flex items-start gap-1.5 text-sm text-muted-foreground;
}

.quote-icon {
  @apply flex-shrink-0 mt-0.5;
  color: hsl(var(--game-purple));
}

/* ===== Modal ===== */
.modal-overlay {
  @apply fixed inset-0 flex items-center justify-center z-50;
  background: rgba(10, 15, 28, 0.9);
  backdrop-filter: blur(8px);
}

.modal-content {
  @apply max-w-lg w-11/12 rounded-2xl;
  background: hsl(var(--card));
  border: 1px solid hsl(var(--primary) / 0.3);
  box-shadow: 0 0 20px hsl(var(--primary) / 0.15), 0 4px 24px rgba(0, 0, 0, 0.4);
}

.victory-modal {
  border-color: hsl(var(--game-gold));
  box-shadow: 0 0 30px hsl(var(--game-gold) / 0.3), 0 4px 24px rgba(0, 0, 0, 0.4);
}

.gameover-modal {
  border-color: hsl(var(--game-red));
  box-shadow: 0 0 20px hsl(var(--game-red) / 0.25), 0 4px 24px rgba(0, 0, 0, 0.4);
}

/* ===== Intro Section ===== */
.intro-immersive {
  background: radial-gradient(circle at 20% 20%, rgba(105, 159, 255, 0.08), transparent 35%),
              radial-gradient(circle at 80% 0%, rgba(92, 232, 180, 0.08), transparent 40%),
              linear-gradient(135deg, #0f172a, #0a0f1c 70%, #0d1325);
  @apply text-foreground p-7 rounded-2xl border border-white/10 relative overflow-hidden;
}

.intro-hero {
  @apply grid grid-cols-1 gap-4 items-stretch mb-5 relative;
}

@media (min-width: 992px) {
  .intro-hero {
    grid-template-columns: 2fr 1fr;
  }
}

.intro-hero__content {
  @apply z-10 pr-2;
}

.intro-hero__glow {
  @apply absolute inset-0 pointer-events-none;
  background: radial-gradient(circle at 30% 30%, rgba(86, 147, 255, 0.12), transparent 45%),
              radial-gradient(circle at 80% 20%, rgba(0, 255, 148, 0.1), transparent 40%);
  filter: blur(40px);
  opacity: 0.9;
}

.intro-hero__stats {
  @apply backdrop-blur-md bg-white/90 border-none rounded-lg;
}

.intro-panel {
  @apply bg-white/5 border border-white/10 rounded-xl p-4 text-foreground backdrop-blur-md;
}

.intro-panel h5 {
  @apply text-blue-200 tracking-wide;
}

.intro-list {
  @apply list-none pl-0 mb-3;
}

.intro-list li {
  @apply relative pl-5 mb-2;
}

.intro-list li::before {
  content: "";
  @apply absolute left-0 top-2 w-2 h-2 rounded-full;
  background: linear-gradient(135deg, #5be7b4, #6fa8ff);
  box-shadow: 0 0 10px rgba(111, 168, 255, 0.5);
}

.intro-steps {
  @apply list-decimal pl-5 text-foreground;
}

.intro-panels {
  @apply relative z-10;
}

/* ===== Animated Counter ===== */
.animated-counter {
  @apply font-bold;
  font-variant-numeric: tabular-nums;
  transition: all 0.15s ease-out;
}

.animated-counter--increase {
  color: hsl(var(--game-green));
  text-shadow: 0 0 8px hsl(var(--game-green) / 0.15);
}

.animated-counter--decrease {
  color: hsl(var(--game-red));
  text-shadow: 0 0 8px hsl(var(--game-red) / 0.15);
}

/* ===== Animations ===== */
@keyframes risk-pulse {
  0%, 100% { box-shadow: 0 0 8px rgba(239, 68, 68, 0.15); }
  50% { box-shadow: 0 0 20px rgba(239, 68, 68, 0.5); }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
  20%, 40%, 60%, 80% { transform: translateX(4px); }
}

/* ===== Reduced Motion ===== */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ===== Mobile Touch Optimizations ===== */
@media (max-width: 1023px) {
  /* Ensure minimum 44px tap targets (Apple HIG) */
  button,
  .action-btn,
  .clickable {
    min-height: 44px;
  }

  /* 2-column action grid on mobile */
  .actions-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
  }

  /* Compact action cards for mobile grid */
  .action-btn {
    @apply px-3 py-3 mb-0;
    min-height: 100px;
  }

  .action-btn__name {
    @apply text-sm;
  }

  .action-btn__description {
    @apply text-xs line-clamp-2;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .action-btn__cost {
    @apply flex-wrap gap-1.5;
  }

  .cost-item {
    @apply text-[10px] px-1.5;
  }

  /* Larger stats bar on mobile */
  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
  }

  /* Compact advisors on mobile */
  .advisor-card {
    @apply p-3;
  }

  .advisor-avatar {
    @apply w-8 h-8 text-sm;
  }

  .advisor-name {
    @apply text-sm;
  }

  /* Map takes more height on mobile */
  .map-container {
    min-height: 300px;
  }

  /* Event feed compact on mobile */
  .news-feed, .social-feed {
    max-height: 150px;
  }
}

/* Touch-specific styles - improved touch feedback on touch devices */
@media (hover: none) {
  /* Reset hover states on touch devices */
  .action-btn:hover:not(:disabled) {
    border-color: rgba(255, 255, 255, 0.08);
    box-shadow: none;
    transform: none;
  }

  .stat-card:hover {
    @apply bg-white/5;
    transform: none;
  }

  .advisor-card:hover {
    border-color: rgba(255, 255, 255, 0.1);
    box-shadow: none;
  }

  .tweet-card:hover {
    @apply bg-white/5;
    border-color: rgba(255, 255, 255, 0.1);
  }

  /* Enhanced active state for touch feedback */
  .action-btn:active:not(:disabled) {
    background: linear-gradient(135deg, hsl(var(--primary) / 0.15), hsl(var(--accent) / 0.1));
    border-color: hsl(var(--primary) / 0.5);
    box-shadow: 0 0 16px hsl(var(--primary) / 0.2);
    transform: scale(0.97);
    transition: all 0.1s ease-out;
  }

  .stat-card:active {
    @apply bg-white/15;
    transform: scale(0.98);
    transition: transform 0.1s ease-out;
  }

  .advisor-card:active {
    border-color: hsl(var(--game-purple) / 0.5);
    background: hsl(var(--game-purple) / 0.1);
    transform: scale(0.98);
  }

  .tweet-card:active {
    background: hsl(var(--primary) / 0.1);
    border-color: hsl(var(--primary) / 0.5);
    transform: scale(0.98);
  }

  /* Visual touch ripple effect */
  .action-btn {
    position: relative;
    overflow: hidden;
  }

  .action-btn::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, hsl(var(--primary) / 0.25), transparent 70%);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease-out;
  }

  .action-btn:active::after {
    opacity: 1;
  }
}

/* Safe area padding for notched devices */
@supports (padding: max(0px)) {
  .container {
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }
}

/* Prevent pull-to-refresh on mobile */
html {
  overscroll-behavior: none;
}

/* Disable text selection on game UI elements */
.action-btn,
.stat-card,
.advisor-card {
  -webkit-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

/* ===== Victory Tracker ===== */
.victory-tracker {
  @apply bg-card/90 backdrop-blur-md border border-border rounded-xl overflow-hidden;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3);
}

.victory-tracker__summary {
  @apply w-full p-3 flex items-center justify-between cursor-pointer;
  @apply bg-transparent hover:bg-muted/30 transition-colors;
  border: none;
}

.victory-tracker__header {
  @apply flex items-center gap-2;
}

.victory-tracker__title {
  @apply text-sm font-semibold text-foreground;
}

.victory-tracker__preview {
  @apply flex items-center gap-3;
}

.victory-tracker__closest {
  @apply flex items-center gap-1.5;
}

.victory-tracker__details {
  @apply px-3 pb-3 space-y-3 overflow-hidden;
  border-top: 1px solid hsl(var(--border));
}

/* Victory Path Card */
.victory-path {
  @apply bg-muted/30 rounded-lg p-3;
  transition: all 0.2s ease;
}

.victory-path:hover {
  @apply bg-muted/50;
}

.victory-path--disabled {
  @apply opacity-50;
}

.victory-path__header {
  @apply flex items-center gap-2 mb-2;
}

.victory-path__icon {
  @apply p-1.5 rounded-md flex-shrink-0;
}

.victory-path__info {
  @apply flex-1 min-w-0;
}

.victory-path__name {
  @apply text-sm font-semibold text-foreground leading-tight;
}

.victory-path__desc {
  @apply text-xs text-muted-foreground truncate;
}

.victory-path__progress {
  @apply text-sm font-bold;
}

.victory-path__bar-container {
  @apply h-1.5 bg-secondary rounded-full overflow-hidden mb-2;
}

.victory-path__bar {
  @apply h-full rounded-full;
  background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)));
}

.victory-path__requirements {
  @apply flex flex-wrap gap-x-4 gap-y-1;
}

.victory-requirement {
  @apply flex items-center gap-1.5 text-xs;
}

.victory-requirement__label {
  @apply text-muted-foreground;
}

.victory-requirement__value {
  @apply font-mono;
}

.victory-path__complete {
  @apply mt-2 flex items-center gap-1 text-xs text-risk-safe font-semibold;
  @apply bg-risk-safe/10 px-2 py-1 rounded-md w-fit;
}

.victory-path__warning {
  @apply mt-2 flex items-center gap-1 text-xs text-risk-caution;
}
